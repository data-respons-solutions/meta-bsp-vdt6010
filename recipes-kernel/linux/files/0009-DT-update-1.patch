From b59bb306335dc6b6ac733127ad3cfb9341fb61c0 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Mikko=20Salom=C3=A4ki?= <ms@datarespons.se>
Date: Wed, 15 May 2019 15:16:57 +0200
Subject: [PATCH] DT - update 1

---
 arch/arm/boot/dts/datarespons-vdt6010-revA.dts | 167 ++++++++++++++-----------
 1 file changed, 95 insertions(+), 72 deletions(-)

diff --git a/arch/arm/boot/dts/datarespons-vdt6010-revA.dts b/arch/arm/boot/dts/datarespons-vdt6010-revA.dts
index f312f186e9ed..fa6df736bc25 100644
--- a/arch/arm/boot/dts/datarespons-vdt6010-revA.dts
+++ b/arch/arm/boot/dts/datarespons-vdt6010-revA.dts
@@ -19,10 +19,7 @@
 
 //FIXME: GPIOS
 // PCIE_RST_B
-// RS422EN2
-// RS485EN2
-// RS232EN2
-// GPIO_Debug_LED
+
 // MMC_RST# -> emmc
 // MCU_NRST
 // Touch_Rest
@@ -39,6 +36,8 @@
 	aliases {
 		mxcfb0 = &mxcfb1;
 		mxcfb1 = &mxcfb2;
+		rtc0 = &s35390a_rtc;
+		rtc1 = &snvs_rtc;
 	};
 	
 	memory: memory {
@@ -83,6 +82,7 @@
 			regulator-max-microvolt = <3300000>;
 			gpio = <&gpio1 6 GPIO_ACTIVE_HIGH>;
 			enable-active-high;
+			regulator-always-on;
 		};
 		
 		reg_lcd_backlight: lcd_backlight {
@@ -98,27 +98,25 @@
 	
 	backlight {
 		compatible = "pwm-backlight";
-		pwms = <&pwm1 0 500000>;
+		pwms = <&pwm1 0 1000000>;
         brightness-levels = < 0 1 2 3 4 5 6 8  11 16  23  32 48
                               64 81 100 121 144 169 196 225
                               256 289 324 361 400 441 484 529
                               576 625 676 729 784 841 900 961
                               1024 1089 1156 1225 1296 1369 1444 1521
                               1600 1681 1764 1849 1936 2025 2116 2209 >;
-		default-brightness-level = <32>;
+		default-brightness-level = <2209>;
 		enable-gpios = <&gpio7 12 GPIO_ACTIVE_HIGH>;
 		power-supply = <&reg_lcd_backlight>;
 		status = "okay";
 	};
 
-	
-	
 	leds {
 		compatible = "gpio-leds";
-
-		debug-led {
-			label = "debug";
-			gpios = <&gpio7 8 GPIO_ACTIVE_HIGH>;
+		
+		GPIO_Debug_LED {
+			label = "GPIO_Debug_LED";
+			gpios =<&gpio7 8 GPIO_ACTIVE_HIGH>;
 		};
 	};
 	
@@ -183,13 +181,34 @@
         };
         
         usb_hub_rst {
-        	gpios = <&gpio4 5 GPIO_ACTIVE_LOW>;
+        	gpios = <&gpio5 17 GPIO_ACTIVE_LOW>;
         	status = "okay";
         	value = <0>;
 		};
-        
-	};
-	
+		
+		/*
+		* F81439N - RS232/RS422/RS485 transceiver config
+		* Default mode RS232 => RS485EN2 = <1>
+		*/
+		RS232EN2 {
+        	gpios = <&gpio4 9 GPIO_ACTIVE_HIGH>;
+        	status = "okay";
+        	value = <0>;
+		};
+		
+		RS422EN2 {
+        	gpios = <&gpio4 10 GPIO_ACTIVE_HIGH>;
+        	status = "okay";
+        	value = <0>;
+		};
+		
+		RS485EN2 {
+        	gpios = <&gpio4 11 GPIO_ACTIVE_HIGH>;
+        	status = "okay";
+        	value = <1>;
+		};        
+	};	
+		
 	mxcfb1: fb@0 {
 		compatible = "fsl,mxc_sdc_fb";
 		disp_dev = "ldb";
@@ -208,7 +227,7 @@
 		default_bpp = <32>;
 		int_clk = <0>;
 		late_init = <0>;
-		status = "okay";
+		status = "disabled";
 	};
 	
 	v4l2_out {
@@ -244,19 +263,9 @@
 		spi-max-frequency = <20000000>;
 		reg = <0>;
 		
-		partition@0 {
-			label = "empty";
-			reg = <0 0x400>;
-		};
-		
-		spl@400 {
-			label = "spl";
-			reg = <0x400 0x40000>;
-		};
-		
-		uboot@40000 {
-			label = "uboot";
-			reg = <0x40000 0x13a000>;
+		uboot@0 {
+			label ="uboot";
+			reg = <0x0 0xc0000>;
 		};
 	};
 };
@@ -397,28 +406,27 @@
 	pinctrl-0 = <&pinctrl_i2c3>;
 	status = "okay";
 
-	rtc: s35390a@30 {
+	s35390a_rtc: rtc@30 {
         compatible = "s35390a";
         reg = <0x30>;
     };
 
-	ilitek@41 {
+	ili2511_touch: touch@41 {
 		compatible = "tchip,ilitek";
 		reg = <0x41>;
-		interrupt-parent = <&gpio5>;
-		interrupts = <11 0x0>;
+		/*interrupt-parent = <&gpio5>;
+		interrupts = <11 IRQ_TYPE_EDGE_FALLING>;
+		reset-gpios = <&gpio5 12 GPIO_ACTIVE_HIGH>;
 		vdd-supply = <&gpio5>;
-		vcc_i2c-supply = <&gpio5>;
-		ilitek,irq-gpio = <&gpio5 11 0x0>;
-		ilitek,reset-gpio = <&gpio5 12 0x0>;
-		ilitek,vbus = "vcc_i2c";
-		ilitek,vdd = "vdd";
+		vcc_i2c-supply = <&gpio5>;*/
+		ilitek,irq-gpio = <&gpio5 11 IRQ_TYPE_EDGE_FALLING>;
+		ilitek,reset-gpio = <&gpio5 12 GPIO_ACTIVE_HIGH>;
+		/*ilitek,vbus = "vcc_i2c";
+		ilitek,vdd = "vdd";*/
 		ilitek,name = "ilitek_i2c";
 	};
 };
 
-
-
 &pwm1 {
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_pwm1>;
@@ -460,14 +468,26 @@
 	status = "okay";		
 };
 
-/* use for LAN8710 */
 &fec {
 	pinctrl-names = "default";
     pinctrl-0 = <&pinctrl_enet>;
     phy-mode = "rmii";
-    phy-reset-gpios = <&gpio6 14 GPIO_ACTIVE_HIGH>; /* FIXME: ska de va ACTIVE_HIGH? */
-	/*fsl,magic-packet; FIXME: vad Ã¤r detta */
+    /* phy-reset-gpios = <&gpio6 14 GPIO_ACTIVE_LOW>; ALREADY RESET BY BOOTLOADER */
+    /*phy-handle = <&lan8710>;*/
 	status = "okay";
+	/*
+	mdio {
+		#address-cells = <1>;
+		#size-cells = <0>;
+		
+		lan8710: ethernet-phy@0 {
+			compatible = "ethernet-phy-ieee802.3-c22";
+			reg = <0>;
+			max-speed = <100>;
+			interrupt-parent = <&gpio1>;
+			interrupts = <9 IRQ_TYPE_EDGE_FALLING>;
+		};
+	};*/
 };
 
 /* use for RS232,RS422,RS485 */
@@ -544,34 +564,33 @@
 				
 				/* display */
 				MX6QDL_PAD_GPIO_17__GPIO7_IO12		0x00002060 /* LED_EN */
-				MX6QDL_PAD_DISP0_DAT17__GPIO5_IO11	0xC0000000 /* Touch_INT */
-				MX6QDL_PAD_DISP0_DAT18__GPIO5_IO12	0x00002060 /* Touch_Rest */
-				
-				MX6QDL_PAD_KEY_ROW1__GPIO4_IO09		0x00002060 //RS232EN2
-				MX6QDL_PAD_KEY_COL2__GPIO4_IO10		0x00002060 //RS422EN2
-				MX6QDL_PAD_KEY_ROW2__GPIO4_IO11		0x00002060 //RS485EN2
-				MX6QDL_PAD_GPIO_3__GPIO1_IO03		0x40000000 //RTC_IRQ
 				
-				MX6QDL_PAD_GPIO_9__GPIO1_IO09		0xC0000000 //LAN8710 ENET_IRQ#
+				/* touch */
+				MX6QDL_PAD_DISP0_DAT17__GPIO5_IO11	0x0001b000 /* Touch_INT */
+				MX6QDL_PAD_DISP0_DAT18__GPIO5_IO12	0x00002060 /* Touch_Rest */
 
-				MX6QDL_PAD_DISP0_DAT23__GPIO5_IO17	0x00002060 /* USB_HUB_RST */
-				
+				/* leds */
+				MX6QDL_PAD_SD3_RST__GPIO7_IO08		0x00002060 /* GPIO_Debug_LED */
 				
+				/* user-gpio */
+				MX6QDL_PAD_DISP0_DAT9__GPIO4_IO30	0x00012000	/* gpio1 */
+				MX6QDL_PAD_DISP0_DAT10__GPIO4_IO31  0x00012000	/* gpio2 */
+				MX6QDL_PAD_DISP0_DAT11__GPIO5_IO05  0x00012000	/* gpio3 */
+				MX6QDL_PAD_DISP0_DAT12__GPIO5_IO06  0x00012000	/* gpio4 */
+				MX6QDL_PAD_DISP0_DAT13__GPIO5_IO07  0x00012000	/* gpio5 */
+				MX6QDL_PAD_DISP0_DAT14__GPIO5_IO08  0x00012000	/* gpio6 */
+				MX6QDL_PAD_DISP0_DAT15__GPIO5_IO09  0x00012000	/* gpio7 */
+				MX6QDL_PAD_DISP0_DAT16__GPIO5_IO10  0x00012000	/* gpio8 */
+				MX6QDL_PAD_KEY_ROW1__GPIO4_IO09		0x00002060	/* RS232EN2 */
+				MX6QDL_PAD_KEY_COL2__GPIO4_IO10		0x00002060	/* RS422EN2 */
+				MX6QDL_PAD_KEY_ROW2__GPIO4_IO11		0x00002060	/* RS485EN2 */
 				
+				/* misc */
+				MX6QDL_PAD_DISP0_DAT23__GPIO5_IO17	0x00002060 /* USB_HUB_RST */	
+				MX6QDL_PAD_GPIO_3__GPIO1_IO03		0x40000000	/* RTC_IRQ - UNUSED */
 				MX6QDL_PAD_GPIO_0__GPIO1_IO00		0xC0000000 /*  GPIO_MCU   */
 				MX6QDL_PAD_DISP0_DAT19__GPIO5_IO13	0x4001b0b0 /*  CPU_GPIO_OUT    */
-
-				
 				
-				// gpio default config as inputs
-				MX6QDL_PAD_DISP0_DAT9__GPIO4_IO30	0x00012000 // gpio1
-				MX6QDL_PAD_DISP0_DAT10__GPIO4_IO31  0x00012000 // gpio2
-				MX6QDL_PAD_DISP0_DAT11__GPIO5_IO05  0x00012000 // gpio3
-				MX6QDL_PAD_DISP0_DAT12__GPIO5_IO06  0x00012000 // gpio4
-				MX6QDL_PAD_DISP0_DAT13__GPIO5_IO07  0x00012000 // gpio5
-				MX6QDL_PAD_DISP0_DAT14__GPIO5_IO08  0x00012000 // gpio6
-				MX6QDL_PAD_DISP0_DAT15__GPIO5_IO09  0x00012000 // gpio7
-				MX6QDL_PAD_DISP0_DAT16__GPIO5_IO10  0x00012000 // gpio8			
 			>;
  		};
 
@@ -585,7 +604,6 @@
 			>;
 		};
 		
-		/* For LAN8710 (10/100M RMII)*/
 		pinctrl_enet: enetgrp {
 			fsl,pins = <
 				MX6QDL_PAD_ENET_MDIO__ENET_MDIO		0x1b0b0
@@ -598,7 +616,8 @@
 				MX6QDL_PAD_ENET_TXD0__ENET_TX_DATA0	0x1b0b0
 				MX6QDL_PAD_ENET_TXD1__ENET_TX_DATA1	0x1b0b0
 				MX6QDL_PAD_GPIO_16__ENET_REF_CLK	0x4001b0a8
-				MX6QDL_PAD_NANDF_CS1__GPIO6_IO14	0x00002060 /* RMII_nRST */
+				MX6QDL_PAD_NANDF_CS1__GPIO6_IO14	0x80000000 /* RMII_nRST */
+				MX6QDL_PAD_GPIO_9__GPIO1_IO09		0x80000000 /* ENET_IRQ# */
 			>;
 		};
 
@@ -687,7 +706,7 @@
 
 		pinctrl_pwm1: pwm1grp {
 			fsl,pins = <
-				MX6QDL_PAD_SD1_DAT3__PWM1_OUT	0x1b0b1 /* PWM1_Panel */
+				MX6QDL_PAD_SD1_DAT3__PWM1_OUT	0x80000000 /* PWM1_Panel */
 			>;
 		};
 
@@ -711,21 +730,25 @@
 	};
 };
 
+&snvs_poweroff {
+	status = "okay";
+};
+
 &ldb {
 	status = "okay";
 	
-	lvds-channel@0 {
+	lvds-channel@1 {
 		fsl,data-mapping = "spwg";
 		fsl,data-width = <24>;
-		crtc = "ipu2-di0";
+		crtc = "ipu1-di1";
 		status = "disabled";
 	};
 
-	lvds-channel@1 {
+	lvds-channel@0 {
 		fsl,data-mapping = "spwg";
 		fsl,data-width = <24>;
 		primary;
-		crtc = "ipu1-di1";
+		crtc = "ipu1-di0";
 		fsl,data-width = <18>;
 		status = "okay";
 		

From f5510ac60fb43702adfda3bd5f289524689b06b8 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Mikko=20Salom=C3=A4ki?= <ms@datarespons.se>
Date: Wed, 29 May 2019 13:12:03 +0200
Subject: [PATCH] DT - Add PCIe settings but leave disabled

---
 arch/arm/boot/dts/datarespons-vdt6010-revA.dts | 43 +++++++++++++-------------
 1 file changed, 22 insertions(+), 21 deletions(-)

diff --git a/arch/arm/boot/dts/datarespons-vdt6010-revA.dts b/arch/arm/boot/dts/datarespons-vdt6010-revA.dts
index 3fc04354105e..859dc4b2ef86 100644
--- a/arch/arm/boot/dts/datarespons-vdt6010-revA.dts
+++ b/arch/arm/boot/dts/datarespons-vdt6010-revA.dts
@@ -16,7 +16,6 @@
 #include <dt-bindings/input/input.h>
 #include "imx6q.dtsi"
 
-// PCIE_RST_B
 // MMC_RST# -> emmc
 // MCU_NRST
 // HDMI_SCL - HDMI_SDA - HDMI_DDC_CEC - HDMI_HPD
@@ -443,10 +442,10 @@
 };
 
 &pcie {
-	power-on-gpio;
-	wake-up-gpio = <&gpio4 7 0>;
-	reset-gpio = <&gpio4 8 0>;
-	status = "okay";
+	power-on-gpio; /* This defines it can sleep but who wakes up? */
+	wake-up-gpio = <&gpio4 7 GPIO_ACTIVE_LOW>; /* Where is this used..? */
+	reset-gpio = <&gpio4 8 GPIO_ACTIVE_LOW>;
+	status = "disabled";
 };
 
 &usbotg {
@@ -593,25 +592,27 @@
 				MX6QDL_PAD_SD3_RST__GPIO7_IO08		0x00002060 /* GPIO_Debug_LED */
 				
 				/* user-gpio */
-				MX6QDL_PAD_DISP0_DAT9__GPIO4_IO30	0x00012000	/* gpio1 */
-				MX6QDL_PAD_DISP0_DAT10__GPIO4_IO31  0x00012000	/* gpio2 */
-				MX6QDL_PAD_DISP0_DAT11__GPIO5_IO05  0x00012000	/* gpio3 */
-				MX6QDL_PAD_DISP0_DAT12__GPIO5_IO06  0x00012000	/* gpio4 */
-				MX6QDL_PAD_DISP0_DAT13__GPIO5_IO07  0x00012000	/* gpio5 */
-				MX6QDL_PAD_DISP0_DAT14__GPIO5_IO08  0x00012000	/* gpio6 */
-				MX6QDL_PAD_DISP0_DAT15__GPIO5_IO09  0x00012000	/* gpio7 */
-				MX6QDL_PAD_DISP0_DAT16__GPIO5_IO10  0x00012000	/* gpio8 */
-				MX6QDL_PAD_KEY_ROW1__GPIO4_IO09		0x00002060	/* RS232EN2 */
-				MX6QDL_PAD_KEY_COL2__GPIO4_IO10		0x00002060	/* RS422EN2 */
-				MX6QDL_PAD_KEY_ROW2__GPIO4_IO11		0x00002060	/* RS485EN2 */
+				MX6QDL_PAD_DISP0_DAT9__GPIO4_IO30	0x00012000 /* gpio1 */
+				MX6QDL_PAD_DISP0_DAT10__GPIO4_IO31  0x00012000 /* gpio2 */
+				MX6QDL_PAD_DISP0_DAT11__GPIO5_IO05  0x00012000 /* gpio3 */
+				MX6QDL_PAD_DISP0_DAT12__GPIO5_IO06  0x00012000 /* gpio4 */
+				MX6QDL_PAD_DISP0_DAT13__GPIO5_IO07  0x00012000 /* gpio5 */
+				MX6QDL_PAD_DISP0_DAT14__GPIO5_IO08  0x00012000 /* gpio6 */
+				MX6QDL_PAD_DISP0_DAT15__GPIO5_IO09  0x00012000 /* gpio7 */
+				MX6QDL_PAD_DISP0_DAT16__GPIO5_IO10  0x00012000 /* gpio8 */
+				MX6QDL_PAD_KEY_ROW1__GPIO4_IO09		0x00002060 /* RS232EN2 */
+				MX6QDL_PAD_KEY_COL2__GPIO4_IO10		0x00002060 /* RS422EN2 */
+				MX6QDL_PAD_KEY_ROW2__GPIO4_IO11		0x00002060 /* RS485EN2 */
+				
+				/* pcie */
+				MX6QDL_PAD_KEY_ROW0__GPIO4_IO07		0x000100b0 /* PCIE_WAKE_B */
+				MX6QDL_PAD_KEY_COL1__GPIO4_IO08		0x0001b0b0 /* PCIE_RST_B */
 				
 				/* misc */
 				MX6QDL_PAD_DISP0_DAT23__GPIO5_IO17	0x00002060 /* USB_HUB_RST */	
-				MX6QDL_PAD_GPIO_3__GPIO1_IO03		0x40000000	/* RTC_IRQ - UNUSED */
-				MX6QDL_PAD_GPIO_0__GPIO1_IO00		0x000100b0 /*  GPIO_MCU   */
-				MX6QDL_PAD_DISP0_DAT19__GPIO5_IO13	0x4001b0b0 /*  CPU_GPIO_OUT    */
-
-				
+				MX6QDL_PAD_GPIO_3__GPIO1_IO03		0x40000000 /* RTC_IRQ - UNUSED */
+				MX6QDL_PAD_GPIO_0__GPIO1_IO00		0x000100b0 /* GPIO_MCU   */
+				MX6QDL_PAD_DISP0_DAT19__GPIO5_IO13	0x4001b0b0 /* CPU_GPIO_OUT    */			
 			>;
  		};
 

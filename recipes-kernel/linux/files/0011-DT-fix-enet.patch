From 3a0afcbc913b0da0c3ce16f8b4c45dbeb0c0dab6 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Mikko=20Salom=C3=A4ki?= <ms@datarespons.se>
Date: Mon, 20 May 2019 15:19:21 +0200
Subject: [PATCH] DT - fix enet

---
 arch/arm/boot/dts/datarespons-vdt6010-revA.dts | 20 ++++++++++++++++----
 1 file changed, 16 insertions(+), 4 deletions(-)

diff --git a/arch/arm/boot/dts/datarespons-vdt6010-revA.dts b/arch/arm/boot/dts/datarespons-vdt6010-revA.dts
index e2d1b6b0d06f..b07c5c083647 100644
--- a/arch/arm/boot/dts/datarespons-vdt6010-revA.dts
+++ b/arch/arm/boot/dts/datarespons-vdt6010-revA.dts
@@ -454,7 +454,12 @@
 	pinctrl-names = "default";
     pinctrl-0 = <&pinctrl_enet>;
     phy-mode = "rmii";
-    phy-reset-gpios = <&gpio6 14 GPIO_ACTIVE_HIGH>;
+    fsl,magic-packet;
+    phy-reset-gpios = <&gpio6 14 GPIO_ACTIVE_LOW>;
+    phy-reset-duration = <1>;
+    assigned-clocks = <&clks IMX6QDL_CLK_ENET_REF>;
+	assigned-clock-rates = <50000000>;
+
     phy-handle = <&lan8710>;
 	status = "okay";
 	
@@ -465,7 +470,13 @@
 		lan8710: ethernet-phy@0 {
 			compatible = "ethernet-phy-ieee802.3-c22";
 			reg = <0>;
-			max-speed = <100>;
+/*
+			reset-gpios = <&gpio6 14 GPIO_ACTIVE_LOW>;
+			reset-assert-us = <1000>;
+			reset-deassert-us = <2000>;
+*/		
+			smsc,disable-energy-detect;
+			
 			interrupt-parent = <&gpio1>;
 			interrupts = <9 IRQ_TYPE_EDGE_FALLING>;
 		};
@@ -584,6 +595,7 @@
 				MX6QDL_PAD_GPIO_3__GPIO1_IO03		0x40000000	/* RTC_IRQ - UNUSED */
 				MX6QDL_PAD_GPIO_0__GPIO1_IO00		0xC0000000 /*  GPIO_MCU   */
 				MX6QDL_PAD_DISP0_DAT19__GPIO5_IO13	0x4001b0b0 /*  CPU_GPIO_OUT    */
+
 				
 			>;
  		};
@@ -610,8 +622,8 @@
 				MX6QDL_PAD_ENET_TXD0__ENET_TX_DATA0	0x1b0b0
 				MX6QDL_PAD_ENET_TXD1__ENET_TX_DATA1	0x1b0b0
 				MX6QDL_PAD_GPIO_16__ENET_REF_CLK	0x4001b0a8
-				MX6QDL_PAD_NANDF_CS1__GPIO6_IO14	0x80000000 /* RMII_nRST */
-				MX6QDL_PAD_GPIO_9__GPIO1_IO09		0x80000000 /* ENET_IRQ# */
+				MX6QDL_PAD_NANDF_CS1__GPIO6_IO14	0x1b0b0 /* RMII_nRST */
+				MX6QDL_PAD_GPIO_9__GPIO1_IO09		0x1b0b0 /* ENET_IRQ# */
 			>;
 		};
 
